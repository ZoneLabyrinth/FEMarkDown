

![img](http://ww2.sinaimg.cn/large/006tNc79ly1g4lh5h5e1uj30cc073ta1.jpg)

![img](http://ww3.sinaimg.cn/large/006tNc79ly1g4lh6jgpg8j30g706naaf.jpg)



![img](http://ww2.sinaimg.cn/large/006tNc79ly1g4lhztrcdnj30u70u0q9r.jpg)





**只要是在网络上跑的包，都是完整的。可以有下层没上层，绝对不可能有上层没下层。**

**对 TCP 协议来说，三次握手也好，重试也好，要想发出去包，就要有 IP 层和 MAC 层，不然是发不出去的**



所谓的二层设备、三层设备，都是这些设备上跑的程序不同而已。一个 HTTP 协议的包经过一个二层设备，二层设备收进去的是整个网络包。这里面 HTTP、TCP、 IP、 MAC 都有。什么叫二层设备呀，就是只把 MAC 头摘下来，看看到底是丢弃、转发，还是自己留着。那什么叫三层设备呢？就是把 MAC 头摘下来之后，再把 IP 头摘下来，看看到底是丢弃、转发，还是自己留着。



### CIDR

求16.158.165.91/22的第一个地址，子网掩码和广播地址

/22不是8的倍数，先变为二进制。前16位不变

即16.158，165位17-24；变为二进制位10100101。去掉16位，还剩下6位，即8位中前6位是网络号，16.158.<101001>，而<01>.91是机器号。



则，第一个地址为16.158.164.1。子网掩码255.255.<111111><00>.0即255.255.252.0。广播地址为16.158.<101001><11>.255。即16.158.167.255



- IP是地址，有定位功能；MAC是身份证，无定位功能；
- CIDR可以用来判断是不是本地人；
- IP分共有的IP和私有的IP。



### DHCP  动态主机配置协议（Dynamic Host Configuration Protocol)

新进入网络（**DHCP Discover**)

![img](http://ww2.sinaimg.cn/large/006tNc79ly1g4lksga105j30do08g752.jpg)

分配地址（**DHCP Offer**）

​	![img](http://ww4.sinaimg.cn/large/006tNc79ly1g4lku0hw7jj30c708gt9n.jpg)



### STP

- **Root Bridge** 根交换机
- **Designated Bridges** 指定交换机
- **Bridge Protoclo Data Units (BFDU)** 网桥协议数据单元  只有根能发，传达根。
- **Priority Vector** 优先级向量 （越小越高） 值 [Root Bridge ID, Root Path Cost,Bridge ID, and PortID]



### ICMP

ping是基于ICMP协议工作的。ICMP全称 **Internet Control Message Protocol**，

就是 **互联网控制报文协议**

ICMP报文是封装在IP包里的。



![img](http://ww4.sinaimg.cn/large/006tNc79ly1g4mlhow3vcj30k50q940s.jpg)





### TCP三次握手

![img](http://ww2.sinaimg.cn/large/006tNc79ly1g4mnkckig6j30ep08yq3r.jpg)

### 四次挥手

![img](http://ww2.sinaimg.cn/large/006tNc79ly1g4mnkufapij30fd0d93zs.jpg)



### TCP状态机

![img](http://ww2.sinaimg.cn/large/006tNc79ly1g4nl705v22j30qa0pdac8.jpg)

